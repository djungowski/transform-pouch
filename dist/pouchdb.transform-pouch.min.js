!function t(n,e,r){function o(u,c){if(!e[u]){if(!n[u]){var s="function"==typeof require&&require;if(!c&&s)return s(u,!0);if(i)return i(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var f=e[u]={exports:{}};n[u][0].call(f.exports,function(t){var e=n[u][1][t];return o(e||t)},f,f.exports,t,n,e,r)}return e[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(t,n,e){(function(n){"use strict";function r(t){return"_"!==t[0]}function o(t){return!("string"!=typeof t._id||!i.isLocalId(t._id))||!!t._deleted&&0===Object.keys(t).filter(r).length}var i=t("./pouch-utils"),u=t("pouchdb-wrappers"),c=t("immediate");e.transform=e.filter=function(t){var e=this,r=function(n){return!o(n)&&t.incoming?t.incoming(i.clone(n)):n},s=function(n){return!o(n)&&t.outgoing?t.outgoing(i.clone(n)):n},a={};"http"===e.type()&&(a.query=function(t){var n={};return t().then(function(t){return i.Promise.all(t.rows.map(function(t){return t.doc?s(t.doc):n})).then(function(e){return e.forEach(function(e,r){e!==n&&(t.rows[r].doc=e)}),t})})}),a.get=function(t){return t().then(function(t){if(Array.isArray(t)){var n={};return i.Promise.all(t.map(function(t){return t.ok?s(t.ok):n})).then(function(e){return e.forEach(function(e,r){e!==n&&(t[r].ok=e)}),t})}return s(t)})};var f=0;a.bulkDocs=function(t,n){f++,console.log("bulkDocs");for(var e=0;e<n.docs.length;e++)n.docs[e]=r(n.docs[e]);return i.Promise.all(n.docs).then(t)},a.allDocs=function(t){return console.log("allDocs"),t().then(function(t){var n={};return i.Promise.all(t.rows.map(function(t){return t.doc?s(t.doc):n})).then(function(e){return e.forEach(function(e,r){e!==n&&(t.rows[r].doc=e)}),t})})},a.changes=function(t){function e(t){return t.doc?i.Promise.resolve(s(t.doc)).then(function(n){return t.doc=n,t}):i.Promise.resolve(t)}function r(t){return i.Promise.all(t.results.map(e)).then(function(n){return t.results=n,t})}var o=t(),u=o.on;o.on=function(t,i){return"change"===t?u.apply(o,[t,function(t){e(t).then(function(t){c(function(){i(t)})})}]):"complete"===t?u.apply(o,[t,function(t){r(t).then(function(t){n.nextTick(function(){i(t)})})}]):u.apply(o,[t,i])};var a=o.then;return o.then=function(t,n){return a.apply(o,[function(e){return r(e).then(t,n)},n])},o},u.installWrapperMethods(e,a)},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(e)}).call(this,t("_process"))},{"./pouch-utils":10,_process:8,immediate:2,"pouchdb-wrappers":7}],2:[function(t,n,e){(function(t){"use strict";function e(){f=!0;for(var t,n,e=l.length;e;){for(n=l,l=[],t=-1;++t<e;)n[t]();e=l.length}f=!1}function r(t){1!==l.push(t)||f||o()}var o,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var u=0,c=new i(e),s=t.document.createTextNode("");c.observe(s,{characterData:!0}),o=function(){s.data=u=++u%2}}else if(t.setImmediate||void 0===t.MessageChannel)o="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var n=t.document.createElement("script");n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n)}:function(){setTimeout(e,0)};else{var a=new t.MessageChannel;a.port1.onmessage=e,o=function(){a.port2.postMessage(0)}}var f,l=[];n.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,n,e){"function"==typeof Object.create?n.exports=function(t,n){t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(t,n){t.super_=n;var e=function(){};e.prototype=n.prototype,t.prototype=new e,t.prototype.constructor=t}},{}],4:[function(t,n,e){"use strict";function r(){}function o(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,t!==r&&s(this,t)}function i(t,n,e){this.promise=t,"function"==typeof n&&(this.onFulfilled=n,this.callFulfilled=this.otherCallFulfilled),"function"==typeof e&&(this.onRejected=e,this.callRejected=this.otherCallRejected)}function u(t,n,e){d(function(){var r;try{r=n(e)}catch(n){return v.reject(t,n)}r===t?v.reject(t,new TypeError("Cannot resolve promise with itself")):v.resolve(t,r)})}function c(t){var n=t&&t.then;if(t&&"object"==typeof t&&"function"==typeof n)return function(){n.apply(t,arguments)}}function s(t,n){function e(n){i||(i=!0,v.reject(t,n))}function r(n){i||(i=!0,v.resolve(t,n))}function o(){n(r,e)}var i=!1,u=a(o);"error"===u.status&&e(u.value)}function a(t,n){var e={};try{e.value=t(n),e.status="success"}catch(t){e.status="error",e.value=t}return e}function f(t){return t instanceof this?t:v.resolve(new this(r),t)}function l(t){var n=new this(r);return v.reject(n,t)}function h(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,o=!1;if(!e)return this.resolve([]);for(var i=new Array(e),u=0,c=-1,s=new this(r);++c<e;)!function(t,r){function c(t){i[r]=t,++u!==e||o||(o=!0,v.resolve(s,i))}n.resolve(t).then(c,function(t){o||(o=!0,v.reject(s,t))})}(t[c],c);return s}function p(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,o=!1;if(!e)return this.resolve([]);for(var i=-1,u=new this(r);++i<e;)!function(t){n.resolve(t).then(function(t){o||(o=!0,v.resolve(u,t))},function(t){o||(o=!0,v.reject(u,t))})}(t[i]);return u}var d=t("immediate"),v={},y=["REJECTED"],m=["FULFILLED"],g=["PENDING"];n.exports=o,o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,n){if("function"!=typeof t&&this.state===m||"function"!=typeof n&&this.state===y)return this;var e=new this.constructor(r);if(this.state!==g){u(e,this.state===m?t:n,this.outcome)}else this.queue.push(new i(e,t,n));return e},i.prototype.callFulfilled=function(t){v.resolve(this.promise,t)},i.prototype.otherCallFulfilled=function(t){u(this.promise,this.onFulfilled,t)},i.prototype.callRejected=function(t){v.reject(this.promise,t)},i.prototype.otherCallRejected=function(t){u(this.promise,this.onRejected,t)},v.resolve=function(t,n){var e=a(c,n);if("error"===e.status)return v.reject(t,e.value);var r=e.value;if(r)s(t,r);else{t.state=m,t.outcome=n;for(var o=-1,i=t.queue.length;++o<i;)t.queue[o].callFulfilled(n)}return t},v.reject=function(t,n){t.state=y,t.outcome=n;for(var e=-1,r=t.queue.length;++e<r;)t.queue[e].callRejected(n);return t},o.resolve=f,o.reject=l,o.all=h,o.race=p},{immediate:2}],5:[function(t,n,e){"use strict";function r(t){return null===t?String(t):"object"==typeof t||"function"==typeof t?a[p.call(t)]||"object":typeof t}function o(t){return null!==t&&t===t.window}function i(t){if(!t||"object"!==r(t)||t.nodeType||o(t))return!1;try{if(t.constructor&&!d.call(t,"constructor")&&!d.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var n;for(n in t);return void 0===n||d.call(t,n)}function u(t){return"function"===r(t)}function c(){for(var t=[],n=-1,e=arguments.length,r=new Array(e);++n<e;)r[n]=arguments[n];var o={};t.push({args:r,result:{container:o,key:"key"}});for(var i;i=t.pop();)s(t,i.args,i.result);return o.key}function s(t,n,e){var r,o,c,s,a,f,l,h=n[0]||{},p=1,d=n.length,y=!1,m=/\d+/;for("boolean"==typeof h&&(y=h,h=n[1]||{},p=2),"object"==typeof h||u(h)||(h={}),d===p&&(h=this,--p);p<d;p++)if(null!=(r=n[p])){l=v(r);for(o in r)if(!(o in Object.prototype)){if(l&&!m.test(o))continue;if(c=h[o],s=r[o],h===s)continue;y&&s&&(i(s)||(a=v(s)))?(a?(a=!1,f=c&&v(c)?c:[]):f=c&&i(c)?c:{},t.push({args:[y,f,s],result:{container:h,key:o}})):void 0!==s&&(v(r)&&u(s)||(h[o]=s))}}e.container[e.key]=h}for(var a={},f=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],l=0;l<f.length;l++){var h=f[l];a["[object "+h+"]"]=h.toLowerCase()}var p=a.toString,d=a.hasOwnProperty,v=Array.isArray||function(t){return"array"===r(t)};n.exports=c},{}],6:[function(t,n,e){"use strict";var r=function(t){return t&&"object"==typeof t&&"default"in t?t.default:t}(t("lie")),o="function"==typeof Promise?Promise:r;n.exports=o},{lie:4}],7:[function(t,n,e){"use strict";function r(t,n,e){for(var r in n)if(n.hasOwnProperty(r)){var i=o(t,r),u=i.base[i.name];if(u)if(u.hasOwnProperty("_handlers")){if(-1!==u._handlers.indexOf(n[r]))throw new Error("Wrapper method for '"+r+"' already installed: "+n[r]);u._handlers.push(n[r])}else i.base[i.name]=e(r,u,n[r],t)}}function o(t,n){for(n=n.split(".");n.length>1;)t=t[n.shift(0)];return{base:t,name:n[0]}}function i(t,n,e,r,o){var u=r[t];if(void 0===i)throw new Error("No known wrapper for method name: "+t);var c=[e],s=u(o,n,c);return s._original=n,s._handlers=c,s}function u(t,n,e,r){return"function"==typeof e&&(r=e,e={}),{base:t||n,db:t||n,options:e||{},callback:r}}function c(t,n,e){var r=n.callback;delete n.callback,e=e.bind(n.base);for(var o=t.length-1;o>=0;o-=1)e=t[o].bind(null,e,n);var i=e();return l(i,r),i}function s(t){return function(){return t.call(this)}}function a(t,n){return function(){return t.call(this,n.options)}}function f(t,n){for(var e in n)if(n.hasOwnProperty(e)){var r=o(t,e),i=r.base[r.name];if(void 0!==i){var u;try{u=i._handlers.indexOf(n[e])}catch(t){u=-1}if(-1===u)throw new Error("Wrapper method for '"+e+"' not installed: "+n[e]);i._handlers.splice(u,1),i._handlers.length||(delete r.base[r.name],r.base[r.name]!==i._original&&(r.base[r.name]=i._original))}}}var l=t("promise-nodify");e.installStaticWrapperMethods=function(t,n){t.new=t.new||function(n,e,r){return new t(n,e,r)},t.destroy=t.destroy||function(n,e,r){var o=u(t,this,e,r),i=new t(n,o.options),c=i.destroy();return l(c,o.callback),c},r(t,n,e.createStaticWrapperMethod)},e.installWrapperMethods=function(t,n){r(t,n,e.createWrapperMethod)},e.createStaticWrapperMethod=function(t,n,e,r){return i(t,n,e,p,r)},e.createWrapperMethod=function(t,n,e,r){return i(t,n,e,h,r)};var h={};h.destroy=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,s(n))}},h.put=function(t,n,e){return function(r,o,i,u,s){var a={};a.base=t||this,a.db=t||this;var f=Array.prototype.slice.call(arguments);a.doc=f.shift();for(var l=("_id"in a.doc);;){var h=f.shift(),p=typeof h;if("string"!==p||l?"string"!==p||!l||"_rev"in a.doc?"object"===p?a.options=h:"function"===p&&(a.callback=h):a.doc._rev=h:(a.doc._id=h,l=!0),!f.length)break}return a.options=a.options||{},c(e,a,function(){return n.call(this,a.doc,a.options)})}},h.post=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.doc=r,c(e,s,function(){return n.call(this,s.doc,s.options)})}},h.get=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.docId=r,c(e,s,function(){return n.call(this,s.docId,s.options)})}},h.remove=function(t,n,e){return function(r,o,i,s){var a;return"string"==typeof o?(a=u(t,this,i,s),a.doc={_id:r,_rev:o}):(a=u(t,this,o,i),a.doc=r),c(e,a,function(){return n.call(this,a.doc,a.options)})}},h.bulkDocs=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return"new_edits"in r&&(s.options.new_edits=r.new_edits),s.docs=r.docs||r,c(e,s,function(){return n.call(this,s.docs,s.options)})}},h.allDocs=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,a(n,i))}},h.changes=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,a(n,i))}},h.sync=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.url=r,c(e,s,function(){return n.call(this,s.url,s.options)})}},h["replicate.from"]=h.sync,h["replicate.to"]=h.sync,h.putAttachment=function(t,n,e){return function(r,o,i,s,a,f,l){var h;return"string"==typeof a?(h=u(t,this,f,l),h.rev=i,h.doc=s,h.type=a):(h=u(t,this,a,f),h.rev=null,h.doc=i,h.type=s),h.docId=r,h.attachmentId=o,c(e,h,function(){return n.call(this,h.docId,h.attachmentId,h.rev,h.doc,h.type)})}},h.getAttachment=function(t,n,e){return function(r,o,i,s){var a=u(t,this,i,s);return a.docId=r,a.attachmentId=o,c(e,a,function(){return n.call(this,a.docId,a.attachmentId,a.options)})}},h.removeAttachment=function(t,n,e){return function(r,o,i,s,a){var f=u(t,this,s,a);return f.docId=r,f.attachmentId=o,f.rev=i,c(e,f,function(){return n.call(this,f.docId,f.attachmentId,f.rev)})}},h.query=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.fun=r,c(e,s,function(){return n.call(this,s.fun,s.options)})}},h.viewCleanup=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,a(n,i))}},h.info=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,s(n))}},h.compact=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,a(n,i))}},h.revsDiff=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.diff=r,c(e,s,function(){return n.call(this,s.diff)})}},h.list=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.path=r,c(e,s,function(){return n.call(this,s.path,s.options)})}},h.rewriteResultRequestObject=h.list,h.show=h.list,h.update=h.list,h.getSecurity=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,a(n,i))}},h.putSecurity=function(t,n,e){return function(r,o,i){var s=u(t,this,o,i);return s.secObj=r,c(e,s,function(){return n.call(this,s.secObj)})}};var p={};p.new=function(t,n,e){return function(r,o,i){var s;return"object"==typeof r?s=u(t,this,r,o):(s=u(t,this,o,i),s.options.name=r),c(e,s,function(){return n.call(this,s.options)})}},p.destroy=function(t,n,e){return function(r,o,i){var s;return"object"==typeof r?s=u(t,this,r,o):(s=u(t,this,o,i),s.options.name=r),s.options.internal?n.apply(t,arguments):c(e,s,function(){var t=s.options.name;return delete s.options.name,n.call(this,t,s.options)})}},p.replicate=function(t,n,e){return function(r,o,i,s){var a=u(t,this,i,s);return a.source=r,a.target=o,c(e,a,function(){return n.call(this,a.source,a.target,a.options)})}},p.allDbs=function(t,n,e){return function(r,o){var i=u(t,this,r,o);return c(e,i,s(n))}},e.uninstallWrapperMethods=function(t,n){f(t,n)},e.uninstallStaticWrapperMethods=function(t,n){f(t,n)}},{"promise-nodify":9}],8:[function(t,n,e){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(n){try{return l.call(null,t,0)}catch(n){return l.call(this,t,0)}}}function u(t){if(h===clearTimeout)return clearTimeout(t);if((h===o||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(n){try{return h.call(null,t)}catch(n){return h.call(this,t)}}}function c(){y&&d&&(y=!1,d.length?v=d.concat(v):m=-1,v.length&&s())}function s(){if(!y){var t=i(c);y=!0;for(var n=v.length;n;){for(d=v,v=[];++m<n;)d&&d[m].run();m=-1,n=v.length}d=null,y=!1,u(t)}}function a(t,n){this.fun=t,this.array=n}function f(){}var l,h,p=n.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{h="function"==typeof clearTimeout?clearTimeout:o}catch(t){h=o}}();var d,v=[],y=!1,m=-1;p.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];v.push(new a(t,n)),1!==v.length||y||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=f,p.addListener=f,p.once=f,p.off=f,p.removeListener=f,p.removeAllListeners=f,p.emit=f,p.prependListener=f,p.prependOnceListener=f,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],9:[function(t,n,e){"use strict";n.exports=function(t,n){"function"==typeof n&&t.then(function(t){n(null,t)},function(t){n(t,null)})}},{}],10:[function(t,n,e){(function(n){"use strict";var r=t("pouchdb-promise");e.once=function(t){var n=!1;return e.getArguments(function(e){if(n)throw console.trace(),new Error("once called  more than once");n=!0,t.apply(this,e)})},e.getArguments=function(t){return function(){for(var n=arguments.length,e=new Array(n),r=-1;++r<n;)e[r]=arguments[r];return t.call(this,e)}},e.toPromise=function(t){return e.getArguments(function(o){var i,u=this,c="function"==typeof o[o.length-1]&&o.pop();c&&(i=function(t,e){n.nextTick(function(){c(t,e)})});var s=new r(function(n,r){try{var i=e.once(function(t,e){t?r(t):n(e)});o.push(i),t.apply(u,o)}catch(t){r(t)}});return i&&s.then(function(t){i(null,t)},i),s.cancel=function(){return this},s})},e.inherits=t("inherits"),e.Promise=r,e.extend=t("pouchdb-extend"),e.clone=function(t){return e.extend(!0,{},t)},e.isLocalId=function(t){return/^_local/.test(t)}}).call(this,t("_process"))},{_process:8,inherits:3,"pouchdb-extend":5,"pouchdb-promise":6}]},{},[1]);
